<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fuzzy Cluster Method Based on the Optimized m Value (Fuzzifier) â€¢ FCMm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Fuzzy Cluster Method Based on the Optimized m Value (Fuzzifier)">
<meta property="og:description" content="Functions provide an improved Fuzzy Clustering Method (FCMm) for optical classification
    of inland waters remote sensing (Bi et al, 2019) &lt;doi:10.1364/OE.27.034838&gt;. Users can 
    train their own high dimensional spectra data to obtain centroids or apply 
    the built-in centroids to new data from inland water systems. The package supports the Chla 
    concentration estimation through published algorithms and finally to return the blending 
    results by assigning optimized algorithm results to specific water types. Spectra plot by
    the package ggplot2, application to image data by the package raster, and other practical
    remote sensing tools are also supported!">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">FCMm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Assessment.html">Algorithms assessment via cluster</a>
    </li>
    <li>
      <a href="articles/Builtin_centrodis.html">Usage of the built in centroids by FCMm</a>
    </li>
    <li>
      <a href="articles/Cluster_new_data.html">Cluster a new dataset by FCMm</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bishun945/FCMm/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="fcmm-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#fcmm-" class="anchor"></a>FCMm <a href="https://github.com/bishun945/FCMm"><img src="reference/figures/logo.png" align="right" height="139"></a>
</h1></div>
<!-- badges: start -->

<p><strong>Author</strong>: Shun Bi<br><strong>Date</strong>: 2021-02-24<br><strong>Version</strong>: 0.11.1<br><strong>E-mail</strong>: <a href="mailto:bishun1994@foxmail.com" class="email">bishun1994@foxmail.com</a></p>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p><code>FCMm</code> is a package for fuzzy clustering water spectra (or called water color). Given that the most of water color spectra data sets are considered as the high dimensional set, the advantage of this method is making FCM assign the membership (sum as 1) harder, ensuring the desired water type are restricted to its belongings (not too soft). It is possible to cluster the harm algal bloom water type which can not be produced by FCM with <code>m=2</code>.</p>
<ul>
<li>If you want to cluster your own data sets, it provides an improved Fuzzy Cluster Method (FCM) by optimizing the fuzzifier value (default but not good being 2).</li>
<li>You can also use the built-in cluster of inland waters produced by <a href="https://www.osapublishing.org/oe/abstract.cfm?uri=oe-27-24-34838">Bi <em>et al.</em> (2019)</a> and can simply obtain the Chlorophyll-a concentration by blending three algorithms with relatively low bias.<br>
</li>
<li>It supports raster (or called imagery) processing (see more details in help documents or vignettes).</li>
<li>It includes several data sets about water color spectra and corresponding water quality parameters and a testing image raster (see help documents for details).</li>
<li>Please see <a href="./NEWS.html">NEWS</a> to get changes in each version.</li>
</ul>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The GitHub version requires the package devtools</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install it from GitHub quickly by `devtools` package</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">'bishun945/FCMm'</span><span class="op">)</span>

<span class="co"># or use `remotes` package</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">'bishun945/FCMm'</span><span class="op">)</span>

<span class="co"># install it and build vignettes </span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">'bishun945/FCMm'</span>, build_vignettes<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<div id="1-classification-of-water-spectra-based-on-pre-defined-cluster-centers" class="section level3">
<h3 class="hasAnchor">
<a href="#1-classification-of-water-spectra-based-on-pre-defined-cluster-centers" class="anchor"></a>1. Classification of water spectra based on pre-defined cluster centers</h3>
<p>This chunk introduces the usage of applying the <code>FCMm</code> package (and its built-in centrodis) to cluster water spectra. The details of obtaining the centrodis could be found in <a href="https://www.osapublishing.org/oe/abstract.cfm?uri=oe-27-24-34838">Bi <em>et al.</em> (2019)</a>. Also, run <code><a href="articles/Builtin_centrodis.html">vignette("Builtin_centrodis")</a></code> to see more about this application.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load testing data</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bishun945/FCMm">FCMm</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"WaterSpec35"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Bi_clusters"</span><span class="op">)</span>
<span class="va">Rrs</span> <span class="op">&lt;-</span> <span class="va">WaterSpec35</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">17</span><span class="op">]</span>
<span class="co"># Plot the spectra</span>
<span class="fu"><a href="reference/plot_spec_from_df.html">plot_spec_from_df</a></span><span class="op">(</span><span class="va">Rrs</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">'Wavelength (nm)'</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Rrs</span><span class="op">~</span><span class="op">(</span><span class="va">sr</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">'none'</span>, text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">13</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Applying FCMm</span>
<span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/apply_FCM_m.html">apply_FCM_m</a></span><span class="op">(</span>Rrs<span class="op">=</span><span class="va">Rrs</span>, option.plot<span class="op">=</span><span class="cn">TRUE</span>, do.stand<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">p.group</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/theme.html">theme</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">13</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-2.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot(result$p.group+facet_wrap(~cluster, ncol=2))</span></code></pre></div>
</div>
<div id="2-algorithms-blending-via-membership-values-from-fcmm-version-of-bi-et-al-2019" class="section level3">
<h3 class="hasAnchor">
<a href="#2-algorithms-blending-via-membership-values-from-fcmm-version-of-bi-et-al-2019" class="anchor"></a>2. Algorithms blending via membership values from FCMm (version of Bi et al., 2019)</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">magrittr</span><span class="op">)</span>
<span class="va">dt_Chla</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/FCM_m_Chla_estimation.html">FCM_m_Chla_estimation</a></span><span class="op">(</span>Rrs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Rrs665<span class="op">=</span><span class="va">Rrs</span><span class="op">$</span><span class="va">`665`</span>,
                                                Rrs709<span class="op">=</span><span class="va">Rrs</span><span class="op">$</span><span class="va">`708.75`</span>,
                                                Rrs754<span class="op">=</span><span class="va">Rrs</span><span class="op">$</span><span class="va">`753.75`</span><span class="op">)</span>,
                                 U<span class="op">=</span><span class="va">result</span><span class="op">$</span><span class="va">u</span><span class="op">)</span>
<span class="va">dt_Chla</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">cluster</span> <span class="op">%&gt;%</span> <span class="va">as.character</span>
<span class="va">dt_Chla</span><span class="op">$</span><span class="va">Chla_true</span> <span class="op">&lt;-</span> <span class="va">WaterSpec35</span><span class="op">$</span><span class="va">Chla</span>

<span class="co"># oldoptions &lt;- options(scipen=1000)</span>

<span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dt_Chla</span>, select<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'cluster'</span>,<span class="st">'Chla_true'</span>,<span class="st">'BR'</span>,<span class="st">'TBA'</span>,<span class="st">'Bloom'</span>,<span class="st">'conc.Blend'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">.</span>, id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'cluster'</span>,<span class="st">'Chla_true'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">.</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Chla_true</span>,y<span class="op">=</span><span class="va">value</span>,group<span class="op">=</span><span class="va">cluster</span>,color<span class="op">=</span><span class="va">cluster</span><span class="op">)</span>,
             alpha<span class="op">=</span><span class="fl">0.8</span>, size<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">900</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/scale_continuous.html">scale_y_log10</a></span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">900</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="reference/Color_plattes.html">RdYlBu</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">K</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">'True value of Chla concentration (ug/L)'</span>,
       y<span class="op">=</span><span class="st">'Estimated value of Chla concentration (ug/L)'</span>,
       color<span class="op">=</span><span class="st">'Cluster'</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept<span class="op">=</span><span class="fl">0</span>, slope<span class="op">=</span><span class="fl">1</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/theme.html">theme</a></span><span class="op">(</span>axis.text.x.bottom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/element.html">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,
        strip.background <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># on.exit(options(oldoptions))</span></code></pre></div>
</div>
<div id="3-assessment-of-chla-concentration-algorithms" class="section level3">
<h3 class="hasAnchor">
<a href="#3-assessment-of-chla-concentration-algorithms" class="anchor"></a>3. Assessment of Chla concentration algorithms</h3>
<p><code>FCMm</code> provides an useful function to assess the performance of algorithms, i.e., <code><a href="reference/Assessment_via_cluster.html">Assessment_via_cluster()</a></code>. Users can decide to select the <code>FCMm</code>-supported error measures (metrics) by themselves (run <code><a href="reference/cal.metrics.html">cal.metrics.names()</a></code> or <code><a href="reference/cal.metrics.vector.html">cal.metrics.vector.names()</a></code> to see what metrics could be used). A more detailed vignette is given to introduce the usage of the assessment work (run <code><a href="articles/Assessment.html">vignette("Assessment")</a></code> to see more).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pred</span> <span class="op">=</span> <span class="va">dt_Chla</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BR"</span>,<span class="st">"TBA"</span>,<span class="st">"Bloom"</span>,<span class="st">"conc.Blend"</span><span class="op">)</span><span class="op">]</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BR"</span>,<span class="st">"TBA"</span>,<span class="st">"Bloom"</span>,<span class="st">"Blend"</span><span class="op">)</span><span class="op">)</span>
<span class="va">meas</span> <span class="op">=</span> <span class="va">dt_Chla</span><span class="op">[</span>,<span class="st">"Chla_true"</span><span class="op">]</span>
<span class="va">memb</span> <span class="op">=</span> <span class="va">dt_Chla</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"M."</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">]</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>
<span class="va">Assess_soft</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Assessment_via_cluster.html">Assessment_via_cluster</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="va">pred</span>,
                                      meas <span class="op">=</span> <span class="va">meas</span>,
                                      memb <span class="op">=</span> <span class="va">memb</span>,
                                      metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MAE"</span>, <span class="st">"MAPE"</span><span class="op">)</span>,
                                      log10 <span class="op">=</span> <span class="cn">TRUE</span>,
                                      total <span class="op">=</span> <span class="cn">TRUE</span>,
                                      hard.mode <span class="op">=</span> <span class="cn">FALSE</span>,
                                      cal.precision <span class="op">=</span> <span class="cn">FALSE</span>,
                                      na.process <span class="op">=</span> <span class="cn">TRUE</span>,
                                      plot.col <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">Assess_soft</span><span class="op">$</span><span class="va">res_plot_facet</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">Assess_soft</span><span class="op">$</span><span class="va">MAE</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">BR</th>
<th align="right">TBA</th>
<th align="right">Bloom</th>
<th align="right">Blend</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">0.254</td>
<td align="right">0.230</td>
<td align="right">0.880</td>
<td align="right">0.229</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">0.214</td>
<td align="right">0.102</td>
<td align="right">0.532</td>
<td align="right">0.106</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">0.243</td>
<td align="right">0.285</td>
<td align="right">1.314</td>
<td align="right">0.130</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">0.197</td>
<td align="right">0.259</td>
<td align="right">0.930</td>
<td align="right">0.196</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="right">0.530</td>
<td align="right">0.419</td>
<td align="right">1.638</td>
<td align="right">0.426</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="right">0.464</td>
<td align="right">0.080</td>
<td align="right">0.162</td>
<td align="right">0.148</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="right">0.168</td>
<td align="right">0.208</td>
<td align="right">0.987</td>
<td align="right">0.162</td>
</tr>
<tr class="even">
<td align="left">SUM</td>
<td align="right">0.254</td>
<td align="right">0.225</td>
<td align="right">0.928</td>
<td align="right">0.200</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">Assess_soft</span><span class="op">$</span><span class="va">MAPE</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">BR</th>
<th align="right">TBA</th>
<th align="right">Bloom</th>
<th align="right">Blend</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">16.64</td>
<td align="right">15.45</td>
<td align="right">64.46</td>
<td align="right">15.32</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">10.64</td>
<td align="right">5.40</td>
<td align="right">28.65</td>
<td align="right">5.54</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">20.24</td>
<td align="right">32.92</td>
<td align="right">131.42</td>
<td align="right">14.26</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">12.57</td>
<td align="right">18.34</td>
<td align="right">66.03</td>
<td align="right">12.53</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="right">114.32</td>
<td align="right">92.40</td>
<td align="right">323.21</td>
<td align="right">94.13</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="right">17.42</td>
<td align="right">3.01</td>
<td align="right">6.10</td>
<td align="right">5.57</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="right">13.83</td>
<td align="right">16.76</td>
<td align="right">75.27</td>
<td align="right">13.08</td>
</tr>
<tr class="even">
<td align="left">SUM</td>
<td align="right">23.96</td>
<td align="right">22.39</td>
<td align="right">88.10</td>
<td align="right">20.03</td>
</tr>
</tbody>
</table>
</div>
<div id="4-algorithms-blending-frameworks-updated-in-feb-22-2021" class="section level3">
<h3 class="hasAnchor">
<a href="#4-algorithms-blending-frameworks-updated-in-feb-22-2021" class="anchor"></a>4. Algorithms blending frameworks (updated in Feb 22, 2021)</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">WaterSpec35</span><span class="op">)</span>
<span class="va">res_Jac17</span> <span class="op">=</span> <span class="fu"><a href="reference/Blend_Jac17.html">Blend_Jac17</a></span><span class="op">(</span><span class="va">WaterSpec35</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">res_Moo14</span> <span class="op">=</span> <span class="fu"><a href="reference/Blend_Moo14.html">Blend_Moo14</a></span><span class="op">(</span><span class="va">WaterSpec35</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">res_Bi21</span>  <span class="op">=</span> <span class="fu"><a href="reference/Blend_Bi21.html">Blend_Bi21</a></span><span class="op">(</span><span class="va">WaterSpec35</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">res_BiPHD</span> <span class="op">=</span> <span class="fu"><a href="reference/Blend_FCMm.html">Blend_FCMm</a></span><span class="op">(</span><span class="va">WaterSpec35</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>

<span class="va">dt_compare</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  Chla_true <span class="op">=</span> <span class="va">WaterSpec35</span><span class="op">$</span><span class="va">Chla</span>,
  Jac17  <span class="op">=</span> <span class="va">res_Jac17</span><span class="op">$</span><span class="va">Chla_blend</span>,
  Moo14  <span class="op">=</span> <span class="va">res_Moo14</span><span class="op">$</span><span class="va">Chla_blend</span>,
  Bi21   <span class="op">=</span> <span class="va">res_Bi21</span><span class="op">$</span><span class="va">Chla_blend</span>,
  BIPHD  <span class="op">=</span> <span class="va">res_BiPHD</span><span class="op">$</span><span class="va">Chla_blend</span>,
  BIPHD2 <span class="op">=</span> <span class="va">res_BiPHD</span><span class="op">$</span><span class="va">Chla_reparam</span>
<span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">.</span>, id <span class="op">=</span> <span class="st">"Chla_true"</span><span class="op">)</span>

<span class="va">er_agg</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">dt_compare</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>
<span class="op">}</span>
<span class="va">dt_compare</span><span class="op">$</span><span class="va">er1</span> <span class="op">&lt;-</span> <span class="va">dt_compare</span><span class="op">$</span><span class="va">Chla_true</span> <span class="op">-</span> <span class="va">dt_compare</span><span class="op">$</span><span class="va">value</span>
<span class="va">dt_compare</span><span class="op">$</span><span class="va">er2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">dt_compare</span><span class="op">$</span><span class="va">Chla_true</span> <span class="op">-</span> <span class="va">dt_compare</span><span class="op">$</span><span class="va">value</span><span class="op">)</span> <span class="op">/</span> <span class="va">dt_compare</span><span class="op">$</span><span class="va">Chla_true</span> <span class="op">*</span> <span class="fl">100</span>

<span class="va">er_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  BIAS <span class="op">=</span> <span class="fu">er_agg</span><span class="op">(</span><span class="va">dt_compare</span><span class="op">$</span><span class="va">er1</span><span class="op">)</span>,
  MAE  <span class="op">=</span> <span class="fu">er_agg</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">dt_compare</span><span class="op">$</span><span class="va">er1</span><span class="op">)</span><span class="op">)</span>,
  MRPE <span class="op">=</span> <span class="fu">er_agg</span><span class="op">(</span><span class="va">dt_compare</span><span class="op">$</span><span class="va">er2</span><span class="op">)</span>,
  MAPE <span class="op">=</span> <span class="fu">er_agg</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">dt_compare</span><span class="op">$</span><span class="va">er2</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">dt_compare</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span>, <span class="va">.</span><span class="op">)</span>
<span class="va">er_df</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"BIAS=%.3f\nMAE=%.3f\nMRPE=%.2f%%\nMAPE=%.2f%%"</span>, 
                       <span class="va">er_df</span><span class="op">$</span><span class="va">BIAS</span>, <span class="va">er_df</span><span class="op">$</span><span class="va">MAE</span>, <span class="va">er_df</span><span class="op">$</span><span class="va">MRPE</span>, <span class="va">er_df</span><span class="op">$</span><span class="va">MAPE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dt_compare</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Chla_true</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span>,
             size <span class="op">=</span> <span class="fl">2.5</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>, color <span class="op">=</span> <span class="st">"black"</span>, 
             shape <span class="op">=</span> <span class="st">"circle filled"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_abline.html">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_text.html">geom_text</a></span><span class="op">(</span>inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, data <span class="op">=</span> <span class="va">er_df</span>,
            <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dt_compare</span><span class="op">$</span><span class="va">Chla_true</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dt_compare</span><span class="op">$</span><span class="va">Chla_true</span><span class="op">)</span>,
                label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="fl">1</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variable</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">"predictions"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/scale_continuous.html">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="getting-help" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-help" class="anchor"></a>Getting help</h2>
<ul>
<li>About this package, I have written several vignettes to present the usage of <code>FCMm</code>. Please read them carefully if you want to use this package for your research. Also, e-mail me via <code>bishun1994@foxmail.com</code> without hesitation if you have any questions or find any bug about it.</li>
<li>If you are more interested in the application of FCM-m about inland water spectra, I recommend you to read <a href="https://www.osapublishing.org/oe/abstract.cfm?uri=oe-27-24-34838">Bi <em>et al.</em> (2019)</a> for more details.</li>
<li>If you want to know some theoretical knowledge about FCM in mathematics, you could read some researches like <a href="https://link.springer.com/article/10.1007/s11634-008-0032-5">Dembele <em>et al.</em> (2018)</a>.</li>
<li>More about FCM in remote sensing applications, you can read <a href="https://www.sciencedirect.com/science/article/pii/S0034425713004434">Moore <em>et al.</em> (2014)</a> and <a href="https://www.sciencedirect.com/science/article/pii/S0034425717301396">Jackson <em>et al.</em> (2017)</a> which focus on Case-II and Case-I waters, respectively.</li>
<li>See more details about optical water types of inland waters in <a href="https://aslopubs.onlinelibrary.wiley.com/doi/abs/10.1002/lno.10674">Spyrakos <em>et al.</em> (2018)</a>
</li>
<li>Hope you will enjoy using this package and have a nice day.</li>
</ul>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ul>
<li>Bi S, Li Y, Xu J, et al.Â Optical classification of inland waters based on an improved Fuzzy C-Means method<span class="math display"><em>J</em></span>. Optics Express, 2019, 27(24): 34838-34856.</li>
<li>Jackson T, Sathyendranath S, MÃ©lin F. An improved optical classification scheme for the Ocean Colour Essential Climate Variable and its applications<span class="math display"><em>J</em></span>. Remote Sensing of Environment, 2017, 203: 152-161.</li>
<li>Moore T S, Dowell M D, Bradt S, et al.Â An optical water type framework for selecting and blending retrievals from bio-optical algorithms in lakes and coastal waters<span class="math display"><em>J</em></span>. Remote sensing of environment, 2014, 143: 97-111.</li>
<li>Spyrakos E, Oâ€™Donnell R, Hunter P D, et al.Â Optical types of inland and coastal waters<span class="math display"><em>J</em></span>. Limnology and Oceanography, 2018, 63(2): 846-870.</li>
<li>Dembele D. Multi-objective optimization for clustering 3-way gene expression data<span class="math display"><em>J</em></span>. Advances in Data Analysis and Classification, 2008, 2(3): 211-225.</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/bishun945/FCMm/">https://â€‹github.com/â€‹bishun945/â€‹FCMm/â€‹</a>
</li>
<li>Report a bug at <br><a href="https://github.com/bishun945/FCMm/issues">https://â€‹github.com/â€‹bishun945/â€‹FCMm/â€‹issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Shun Bi <br><small class="roles"> Author, maintainer, copyright holder </small>  </li>
<li>Yunmei Li <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=FCMm"><img src="https://www.r-pkg.org/badges/version/FCMm" alt="CRAN status"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#stable"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active â€“ The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://travis-ci.org/bishun945/FCMm"><img src="https://travis-ci.org/bishun945/FCMm.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://ci.appveyor.com/project/bishun945/FCMm"><img src="https://ci.appveyor.com/api/projects/status/github/bishun945/FCMm?branch=master&amp;svg=true" alt="AppVeyor build status"></a></li>
<li><a href="https://circleci.com/gh/bishun945/FCMm"><img src="https://circleci.com/gh/bishun945/FCMm.svg?style=svg" alt="CircleCI build status"></a></li>
<li><a href="https://mybinder.org/v2/gh/bishun945/FCMm/master?urlpath=https://mybinder.org/v2/gh/bishun945/FCMm/master"><img src="https://mybinder.org/badge_logo.svg" alt="Launch binder"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Shun Bi, Yunmei Li.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
